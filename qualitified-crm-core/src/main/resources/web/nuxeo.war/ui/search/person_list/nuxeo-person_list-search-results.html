<!--
`nuxeo-person_list-search-results`
@group Nuxeo UI
@element nuxeo-person_list-search-results
-->
<dom-module id="nuxeo-person_list-search-results">
    <template>
        <style include="nuxeo-styles">
      nuxeo-data-table,
      nuxeo-data-grid,
      nuxeo-data-list,
      nuxeo-justified-grid {
        display: block;
        position: relative;
        min-height: calc(100vh - 130px - var(--nuxeo-app-top));
      }
      nuxeo-justified-grid {
        height: calc(100vh - 10em);
      }

        </style>
        <nuxeo-results name="person_list" nx-provider="[[nxProvider]]" selected-items="{{selectedItems}}"
                       display-quick-filters="" display-sort="" sort-label="[[i18n('searchResults.sort.label')]]"
                       sort-options="[[sortOptions]]">

            <nuxeo-data-grid class="results" empty-label="[[i18n('searchResults.noResults')]]" selection-enabled=""
                             icon="nuxeo:view-thumbnails" name="grid">
                <template>
                    <nuxeo-document-grid-thumbnail tabindex$="{{tabIndex}}" selected$="{{selected}}" doc="[[item]]"
                                                   index="[[index]]" on-navigate="_navigate"
                                                   selected-items="[[selectedItems]]">
                    </nuxeo-document-grid-thumbnail>
                </template>
            </nuxeo-data-grid>

            <nuxeo-data-table class="results" settings-enabled="" empty-label="[[i18n('searchResults.noResults')]]"
                              selection-enabled="" on-row-clicked="_navigate" icon="nuxeo:view-list" name="table">

                <nuxeo-data-table-column name="Title" field="dc:title" sort-by="dc:title" flex="90">
                    <template>
                        <nuxeo-document-thumbnail document="[[item]]"></nuxeo-document-thumbnail>
                        <a class="title ellipsis" href$="#!/doc/[[item.uid]]" on-tap="_navigate">[[item.title]]</a>

                    </template>
                </nuxeo-data-table-column>

                <nuxeo-data-table-column name="Role" field="person:Role" sort-by="person:Role" flex="60">
                    <template>
                        [[formatDirectory(item.properties.person:Role)]]
                    </template>
                </nuxeo-data-table-column>

                <nuxeo-data-table-column name="E-mail" field="person:email" sort-by="person:email" flex="100">
                    <template>
                        [[item.properties.person:email]]
                    </template>
                </nuxeo-data-table-column>

                <nuxeo-data-table-column name="Phone Number" field="person:phoneNumber" sort-by="person:phoneNumber"
                                         flex="60">
                    <template>
                        [[item.properties.person:phoneNumber]]
                    </template>
                </nuxeo-data-table-column>

                <nuxeo-data-table-column name="Modified" field="dc:modified" sort-by="dc:modified" flex="60">
                    <template>
                        [[formatDate(item.properties.dc:modified)]]
                    </template>
                </nuxeo-data-table-column>

                <nuxeo-data-table-column name="Last Contributor" field="dc:lastContributor" sort-by="dc:lastContributor"
                                         flex="60">
                    <template>
                        <nuxeo-user-tag user="[[item.properties.dc:lastContributor]]"></nuxeo-user-tag>
                    </template>
                </nuxeo-data-table-column>
            </nuxeo-data-table>

        </nuxeo-results>
    </template>
    <script>
    Polymer({
      is: 'nuxeo-person_list-search-results',
      behaviors: [Nuxeo.LayoutBehavior],
      properties: {
        nxProvider: Object,
        sortOptions: {
          type: Array,
          value: []
        }
      },

      attached: function() {
        this.sortOptions = [
          {field: 'dc:title', label: this.i18n('searchResults.sort.field.title'), order: 'asc'},
          {field: 'dc:created', label: this.i18n('searchResults.sort.field.created'), order: 'asc', selected: true},
          {field: 'dc:modified', label: this.i18n('searchResults.sort.field.modified'), order: 'desc'},
          {field: 'dc:lastContributor', label: this.i18n('searchResults.sort.field.lastContributor'), order: 'asc'},
          {field: 'state', label: this.i18n('searchResults.sort.field.state'), order: 'asc'},
          {field: 'dc:nature', label: this.i18n('searchResults.sort.field.nature'), order: 'asc'},
          {field: 'dc:coverage', label: this.i18n('searchResults.sort.field.coverage'), order: 'asc'}
        ];
      },

       _navigate: function(e) {
        var detail = {
          doc: e.detail.item,
        };
        if(detail.doc){
          page('/doc/' + detail.doc.uid);
        }
      }
    });

    </script>
</dom-module>
