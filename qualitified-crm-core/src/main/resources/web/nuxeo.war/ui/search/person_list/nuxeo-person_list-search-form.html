<!--
`nuxeo-person_list-search-form`
@group Nuxeo UI
@element nuxeo-person_list-search-form
-->
<dom-module id="nuxeo-person_list-search-form">
  <template>
    <style>
      *[role=widget] {
        padding: 5px;
      }
    </style>
    <!-- Full Text -->
    <nuxeo-input role="widget"
                 id="searchInput"
                 type="search"
                 label="[[i18n('defaultSearch.fullText')]]"
                 value="{{searchTerm}}"
                 placeholder="[[i18n('defaultSearch.fullText.placeholder')]]"
                 autofocus
                 on-keydown="_checkForEnter">
    </nuxeo-input>

    <nuxeo-input role="widget" value="{{params.person_firstName}}" label="Person First Name" type="text"></nuxeo-input>
    <nuxeo-input role="widget" value="{{params.person_lastName}}" label="Person Last Name" type="text"></nuxeo-input>
    <div class="layout vertical row">
      <label>Role</label>
      <nuxeo-checkbox-aggregation
              data="[[aggregations.person_role_agg]]"
              value="{{params.person_role_agg}}">
      </nuxeo-checkbox-aggregation>
    </div>

    <div class="layout vertical row">
      <label>Civility</label>
      <nuxeo-checkbox-aggregation
              data="[[aggregations.person_civility_agg]]"
              value="{{params.person_civility_agg}}">
      </nuxeo-checkbox-aggregation>
    </div>
    </template>

  <script>
    Polymer({
      is: 'nuxeo-person_list-search-form',
      behaviors: [Nuxeo.LayoutBehavior],
      properties: {

        /**
         * @search Person_list
         */
        params: {
          type: Object,
          value: {},
          notify: true,
        },

        aggregations: {
          type: Object,
          value: {},
          notify: true,
        },
      searchTerm: {
        type: String,
        notify: true,
        observer: '_addFullTextSearch'
      }

      },

    behaviors: [Nuxeo.I18nBehavior],

    _addFullTextSearch: function() {
      if (this.searchTerm) {
        console.log(this.searchTerm);
        this.set('params.system_fulltext', this.searchTerm + '*');
      } else {
        if (this.params.system_fulltext) {
          this.set('params.system_fulltext', '');
          delete this.params.system_fulltext;
        }
      }
    },
    _checkForEnter: function(e) {
      if (e.keyCode === 13) {
        this.fire('trigger-search');
      }
    },

    clear: function() {
      this.searchTerm = '';
    }
    });
  </script>
</dom-module>
